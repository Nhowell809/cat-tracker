<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Cat Care Tracker</title>
    <script src="https://unpkg.com/react@18/umd/react.development.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/lucide/0.263.1/umd/lucide.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="manifest" href="manifest.json">
    <meta name="theme-color" content="#2563eb">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="default">
    <meta name="apple-mobile-web-app-title" content="Cat Tracker">
    <link rel="apple-touch-icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='90'>üê±</text></svg>">
    <style>
        body {
            margin: 0;
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Roboto', sans-serif;
        }
    </style>
</head>
<body>
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect } = React;
        const { Calendar, Clock, Plus, Check, AlertCircle, Pill } = lucide;

        const CatTracker = () => {
            const [currentDate, setCurrentDate] = useState(new Date().toISOString().split('T')[0]);
            const [logs, setLogs] = useState(() => {
                const saved = localStorage.getItem('catTrackerLogs');
                return saved ? JSON.parse(saved) : [];
            });
            const [activeTab, setActiveTab] = useState('today');

            // Save to localStorage whenever logs change
            useEffect(() => {
                localStorage.setItem('catTrackerLogs', JSON.stringify(logs));
            }, [logs]);

            // Cat configurations
            const cats = {
                regular: {
                    names: ['Jolly', 'Zuko'],
                    wetFood: { amount: '1 can split', frequency: 2, times: ['Morning', 'Evening'] },
                    dryFood: { amount: '1/8 cup each', frequency: 1, times: ['Morning'] }
                },
                sherbet: {
                    names: ['Sherbet'],
                    wetFood: { amount: '1/2 can', frequency: 2, times: ['Morning', 'Evening'] },
                    dryFood: { amount: '1/8 cup prescription', frequency: 1, times: ['Morning'] },
                    medications: {
                        prednisone: { frequency: 'every other day', lastGiven: null },
                        gabapentin: { frequency: 'as needed', lastGiven: null }
                    }
                }
            };

            // Get today's logs
            const getTodaysLogs = () => {
                return logs.filter(log => log.date === currentDate);
            };

            // Check if task is completed today
            const isCompleted = (catGroup, foodType, time = null, medication = null) => {
                const todaysLogs = getTodaysLogs();
                return todaysLogs.some(log => 
                    log.catGroup === catGroup && 
                    log.type === (medication ? 'medication' : 'feeding') &&
                    (medication ? log.medication === medication : (log.foodType === foodType && log.time === time))
                );
            };

            // Add log entry
            const addLog = (catGroup, type, details) => {
                const newLog = {
                    id: Date.now(),
                    date: currentDate,
                    timestamp: new Date().toLocaleTimeString(),
                    catGroup,
                    type,
                    ...details
                };
                setLogs(prev => [...prev, newLog]);
            };

            // Check if Sherbet needs prednisone today
            const needsPredToday = () => {
                const lastPred = logs.filter(log => 
                    log.catGroup === 'sherbet' && 
                    log.type === 'medication' && 
                    log.medication === 'prednisone'
                ).sort((a, b) => new Date(b.date) - new Date(a.date))[0];

                if (!lastPred) return true;
                
                const daysSince = Math.floor((new Date(currentDate) - new Date(lastPred.date)) / (1000 * 60 * 60 * 24));
                return daysSince >= 2;
            };

            const FeedingCard = ({ catGroup, cats: catData }) => (
                React.createElement('div', { className: "bg-white rounded-lg shadow-md p-4 mb-4" },
                    React.createElement('h3', { className: "text-lg font-semibold mb-3 text-gray-800" },
                        catGroup === 'regular' ? 'Jolly & Zuko' : 'Sherbet'
                    ),
                    
                    // Wet Food
                    React.createElement('div', { className: "mb-4" },
                        React.createElement('h4', { className: "font-medium text-gray-700 mb-2" },
                            `Wet Food (${catData.wetFood.amount})`
                        ),
                        React.createElement('div', { className: "grid grid-cols-2 gap-2" },
                            catData.wetFood.times.map(time => 
                                React.createElement('button', {
                                    key: time,
                                    onClick: () => addLog(catGroup, 'feeding', { foodType: 'wet', time }),
                                    className: `p-2 rounded-md text-sm font-medium transition-colors ${
                                        isCompleted(catGroup, 'wet', time)
                                            ? 'bg-green-100 text-green-800 border border-green-300'
                                            : 'bg-blue-50 text-blue-700 border border-blue-200 hover:bg-blue-100'
                                    }`
                                },
                                    isCompleted(catGroup, 'wet', time) ? 
                                        React.createElement(React.Fragment, null,
                                            React.createElement(Check, { size: 16, className: "inline mr-1" }),
                                            ` ${time}`
                                        ) :
                                        React.createElement(React.Fragment, null,
                                            React.createElement(Plus, { size: 16, className: "inline mr-1" }),
                                            ` ${time}`
                                        )
                                )
                            )
                        )
                    ),

                    // Dry Food
                    React.createElement('div', { className: "mb-4" },
                        React.createElement('h4', { className: "font-medium text-gray-700 mb-2" },
                            `Dry Food (${catData.dryFood.amount})`
                        ),
                        React.createElement('div', { className: "grid grid-cols-1 gap-2" },
                            catData.dryFood.times.map(time => 
                                React.createElement('button', {
                                    key: time,
                                    onClick: () => addLog(catGroup, 'feeding', { foodType: 'dry', time }),
                                    className: `p-2 rounded-md text-sm font-medium transition-colors ${
                                        isCompleted(catGroup, 'dry', time)
                                            ? 'bg-green-100 text-green-800 border border-green-300'
                                            : 'bg-blue-50 text-blue-700 border border-blue-200 hover:bg-blue-100'
                                    }`
                                },
                                    isCompleted(catGroup, 'dry', time) ? 
                                        React.createElement(React.Fragment, null,
                                            React.createElement(Check, { size: 16, className: "inline mr-1" }),
                                            ` ${time}`
                                        ) :
                                        React.createElement(React.Fragment, null,
                                            React.createElement(Plus, { size: 16, className: "inline mr-1" }),
                                            ` ${time}`
                                        )
                                )
                            )
                        )
                    ),

                    // Medications (Sherbet only)
                    catGroup === 'sherbet' && React.createElement('div', null,
                        React.createElement('h4', { className: "font-medium text-gray-700 mb-2" }, 'Medications'),
                        React.createElement('div', { className: "space-y-2" },
                            React.createElement('button', {
                                onClick: () => addLog('sherbet', 'medication', { medication: 'prednisone' }),
                                className: `w-full p-2 rounded-md text-sm font-medium transition-colors ${
                                    isCompleted('sherbet', null, null, 'prednisone')
                                        ? 'bg-green-100 text-green-800 border border-green-300'
                                        : needsPredToday()
                                            ? 'bg-orange-50 text-orange-700 border border-orange-200 hover:bg-orange-100'
                                            : 'bg-gray-50 text-gray-500 border border-gray-200'
                                }`,
                                disabled: !needsPredToday() && !isCompleted('sherbet', null, null, 'prednisone')
                            },
                                React.createElement(Pill, { size: 16, className: "inline mr-1" }),
                                isCompleted('sherbet', null, null, 'prednisone') ? 'Prednisone ‚úì' : 
                                needsPredToday() ? 'Give Prednisone' : 'Prednisone (not due)'
                            ),
                            
                            React.createElement('button', {
                                onClick: () => addLog('sherbet', 'medication', { medication: 'gabapentin' }),
                                className: "w-full p-2 rounded-md text-sm font-medium bg-purple-50 text-purple-700 border border-purple-200 hover:bg-purple-100 transition-colors"
                            },
                                React.createElement(Pill, { size: 16, className: "inline mr-1" }),
                                'Give Gabapentin (as needed)'
                            )
                        )
                    )
                )
            );

            const TodaysLogs = () => {
                const todaysLogs = getTodaysLogs().sort((a, b) => new Date(`1970/01/01 ${b.timestamp}`) - new Date(`1970/01/01 ${a.timestamp}`));
                
                return React.createElement('div', { className: "bg-white rounded-lg shadow-md p-4" },
                    React.createElement('h3', { className: "text-lg font-semibold mb-3 text-gray-800 flex items-center" },
                        React.createElement(Clock, { size: 20, className: "mr-2" }),
                        "Today's Activity"
                    ),
                    todaysLogs.length === 0 ? 
                        React.createElement('p', { className: "text-gray-500 text-center py-4" }, 'No activities logged today') :
                        React.createElement('div', { className: "space-y-2" },
                            todaysLogs.map(log => 
                                React.createElement('div', { key: log.id, className: "flex justify-between items-center p-2 bg-gray-50 rounded" },
                                    React.createElement('span', { className: "text-sm" },
                                        log.type === 'feeding' 
                                            ? `${log.catGroup === 'regular' ? 'Jolly & Zuko' : 'Sherbet'} - ${log.foodType} food (${log.time})`
                                            : `Sherbet - ${log.medication}`
                                    ),
                                    React.createElement('span', { className: "text-xs text-gray-500" }, log.timestamp)
                                )
                            )
                        )
                );
            };

            return React.createElement('div', { className: "min-h-screen bg-gray-100" },
                // Header
                React.createElement('div', { className: "bg-blue-600 text-white p-4" },
                    React.createElement('h1', { className: "text-xl font-bold text-center" }, 'Cat Care Tracker'),
                    React.createElement('div', { className: "flex items-center justify-center mt-2" },
                        React.createElement(Calendar, { size: 16, className: "mr-2" }),
                        React.createElement('input', {
                            type: "date",
                            value: currentDate,
                            onChange: (e) => setCurrentDate(e.target.value),
                            className: "bg-blue-500 text-white rounded px-2 py-1 text-sm"
                        })
                    )
                ),

                // Navigation
                React.createElement('div', { className: "bg-white border-b" },
                    React.createElement('div', { className: "flex" },
                        React.createElement('button', {
                            onClick: () => setActiveTab('today'),
                            className: `flex-1 py-3 text-center font-medium ${
                                activeTab === 'today' ? 'text-blue-600 border-b-2 border-blue-600' : 'text-gray-600'
                            }`
                        }, "Today's Tasks"),
                        React.createElement('button', {
                            onClick: () => setActiveTab('history'),
                            className: `flex-1 py-3 text-center font-medium ${
                                activeTab === 'history' ? 'text-blue-600 border-b-2 border-blue-600' : 'text-gray-600'
                            }`
                        }, 'History')
                    )
                ),

                // Content
                React.createElement('div', { className: "p-4" },
                    activeTab === 'today' ? 
                        React.createElement(React.Fragment, null,
                            React.createElement(FeedingCard, { catGroup: "regular", cats: cats.regular }),
                            React.createElement(FeedingCard, { catGroup: "sherbet", cats: cats.sherbet }),
                            React.createElement(TodaysLogs)
                        ) :
                        React.createElement('div', { className: "bg-white rounded-lg shadow-md p-4" },
                            React.createElement('h3', { className: "text-lg font-semibold mb-3 text-gray-800" }, 'Feeding History'),
                            logs.length === 0 ? 
                                React.createElement('p', { className: "text-gray-500 text-center py-4" }, 'No history yet') :
                                React.createElement('div', { className: "space-y-3" },
                                    Object.entries(
                                        logs.reduce((acc, log) => {
                                            if (!acc[log.date]) acc[log.date] = [];
                                            acc[log.date].push(log);
                                            return acc;
                                        }, {})
                                    ).sort(([a], [b]) => new Date(b) - new Date(a)).map(([date, dayLogs]) => 
                                        React.createElement('div', { key: date, className: "border-l-4 border-blue-500 pl-4" },
                                            React.createElement('h4', { className: "font-medium text-gray-800 mb-2" }, 
                                                new Date(date).toLocaleDateString()
                                            ),
                                            dayLogs.map(log => 
                                                React.createElement('div', { key: log.id, className: "text-sm text-gray-600 mb-1" },
                                                    `${log.timestamp} - ${log.type === 'feeding' 
                                                        ? `${log.catGroup === 'regular' ? 'Jolly & Zuko' : 'Sherbet'} - ${log.foodType} food (${log.time})`
                                                        : `Sherbet - ${log.medication}`}`
                                                )
                                            )
                                        )
                                    )
                                )
                        )
                )
            );
        };

        ReactDOM.render(React.createElement(CatTracker), document.getElementById('root'));
    </script>
</body>
</html>